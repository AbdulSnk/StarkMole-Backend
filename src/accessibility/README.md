# Accessibility Support Module (Backend)

This NestJS module provides backend functionalities to support and enforce accessibility best practices, primarily focusing on data validation and API contract consistency. It does **not** perform direct visual or interactive accessibility audits, as those are frontend concerns.

## Features

- **Data Accessibility Validation**: Methods to validate data structures for accessibility attributes (e.g., `alt` text for images).
- **API Contract Consistency**: Encourages consistent API responses that aid frontend accessibility.
- **Error Handling Support**: Promotes clear and consistent error messages.
- **Report Processing**: An endpoint to receive and log accessibility reports generated by frontend tools (e.g., Lighthouse, axe DevTools).

## Installation

1.  Install dependencies:
    \`\`\`bash
    npm install class-validator class-transformer
    \`\`\`
2.  Import `AccessibilityModule` into your `AppModule`:
    \`\`\`typescript
    // src/app.module.ts
    import { Module } from '@nestjs/common';
    import { AccessibilityModule } from './accessibility/accessibility.module';

    @Module({
      imports: [AccessibilityModule],
      // ... other modules
    })
    export class AppModule {}
    \`\`\`

## Usage

### 1. Data Validation in Services

You can inject `AccessibilityService` into your other services to validate data before it's sent to the frontend.

\`\`\`typescript
// src/some-feature/some-feature.service.ts
import { Injectable } from '@nestjs/common';
import { AccessibilityService } from '../accessibility/accessibility.service';
import { ImageWithAltText } from '../accessibility/interfaces/accessibility.interface';

@Injectable()
export class SomeFeatureService {
  constructor(private accessibilityService: AccessibilityService) {}

  createProduct(productData: { name: string; description: string; imageUrl: string; imageAlt: string }) {
    const image: ImageWithAltText = {
      url: productData.imageUrl,
      altText: productData.imageAlt,
    };

    const issues = this.accessibilityService.validateImageAltText(image, 'productData.image');

    if (issues.length > 0) {
      // Log or throw an error based on severity
      console.warn('Accessibility issues found:', issues);
      // Optionally, prevent creation or return a specific error
      // throw new BadRequestException('Image data fails accessibility checks.');
    }

    // Proceed with product creation
  }
}
\`\`\`

### 2. Receiving Frontend Accessibility Reports

Your frontend CI/CD pipeline or a dedicated frontend application can send accessibility audit reports to the `/accessibility/report` endpoint.

\`\`\`bash
# Example using curl (replace with actual report data)
curl -X POST -H "Content-Type: application/json" \
     -d '{
           "reportId": "audit-123",
           "timestamp": "2024-07-29T10:00:00Z",
           "url": "https://your-app.com/dashboard",
           "tool": "Lighthouse",
           "score": 95,
           "issues": [
             {
               "code": "COLOR_CONTRAST",
               "message": "Insufficient color contrast for text.",
               "path": "body > div > h1",
               "severity": "medium"
             }
           ]
         }' \
     http://localhost:3000/accessibility/report
\`\`\`

The `AccessibilityService` will log these reports, and you can extend `processAccessibilityReport` to store them in a database, trigger notifications, or integrate with a dashboard.

## WCAG 2.1 Standards (Backend Relevance)

While WCAG 2.1 primarily guides frontend development, the backend plays a crucial role in providing the necessary data and structure:

-   **Perceivable**: Ensure your API provides data for text alternatives (e.g., `alt` text for images), captions for media, and content that can be presented in various formats.
-   **Operable**: Design APIs that support keyboard navigation on the frontend (e.g., consistent endpoints for actions).
-   **Understandable**: Provide clear, consistent, and predictable API responses and error messages to help users understand and correct mistakes.
-   **Robust**: Maximize compatibility by using standard data formats and well-formed API responses that assistive technologies can reliably consume.

## Future Enhancements

-   **Database Storage**: Persist `AccessibilityReport` data in your database for historical tracking and trend analysis.
-   **Notifications**: Integrate with notification services (email, Slack) to alert teams about critical accessibility issues.
-   **Automated Data Validation**: Implement NestJS Pipes or Decorators to automatically validate DTOs for accessibility concerns before processing.
-   **Integration with CI/CD**: Develop scripts or webhooks to automatically trigger frontend accessibility audits and send reports to this module.
\`\`\`
